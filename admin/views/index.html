<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>网站后台管理模版</title>
    <link rel="stylesheet" type="text/css" href="../../static/admin/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../static/admin/css/admin.css"/>
</head>
<body>
<div class="main-layout" id='main-layout'>
    <!--侧边栏-->
    <div class="main-layout-side">
        <div class="m-logo">
        </div>
        <ul class="layui-nav layui-nav-tree" lay-filter="leftNav" style="margin-right:10px;height:538px;">
        </ul>
    </div>
    <!--右侧内容-->
    <div class="main-layout-container">
        <!--头部-->
        <div class="main-layout-header">
            <div class="menu-btn" id="hideBtn">
                <a href="javascript:;">
                    <span class="iconfont">&#xe60e;</span>
                </a>
            </div>
            <ul class="layui-nav" lay-filter="rightNav">
                <li class="layui-nav-item"><a href="javascript:;" data-url="email.html" data-id='4' data-text="邮件系统"><i class="iconfont">&#xe603;</i></a></li>
                <li class="layui-nav-item">
                    <a href="javascript:;" data-url="admin-info.html" data-id='5' data-text="个人信息">超级管理员</a>
                </li>
                <li class="layui-nav-item"><a href="javascript:;">退出</a></li>
            </ul>
        </div>
        <!--主体内容-->
        <div class="main-layout-body">
            <!--tab 切换-->
            <div class="layui-tab layui-tab-brief main-layout-tab" lay-filter="tab" lay-allowClose="true">
                <ul class="layui-tab-title">
                    <li class="layui-this welcome">后台主页</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show" style="background: #f5f5f5;">
                        <!--1-->
                        <iframe src="../index/welcome.html" width="100%" height="100%" name="iframe" scrolling="auto" class="iframe" framborder="0"></iframe>
                        <!--1end-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--遮罩-->
    <div class="main-mask">

    </div>
</div>
<script type="text/javascript">
    var scope={
        link:'./welcome.html'
    }
</script>
<script src="../../static/admin/layui/layui.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/admin/js/common.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/admin/js/main.js" type="text/javascript" charset="utf-8"></script>
<script>
    layui.use('element', function(){
        var $ = layui.jquery
            ,element = layui.element();

/*        element.on('nav(demo)', function(elem){
            debugger
            //console.log(elem.getAttribute("meun_id")); //得到当前点击的DOM对象
            var id=$(this).attr("data-id");
            if(typeof(id)!="undefined"){
                console.log('进入方法');
                element.tabAdd('demo1', {
                    title: '新选项'+ (Math.random()*1000|0) //用于演示
                    ,content: '<iframe src="test.html" style="width:100%;height:491px;" scrolling="auto" frameborder="0"></iframe>'
                    ,id: id//实际使用一般是规定好的id，这里以时间戳模拟下z
                })
                element.tabChange('demo1', id);
            }
        });*/
        //获取所有的菜单
        $.ajax({
            type:"POST",
            url:"http://localhost:8080/public",
            headers: {
                "Authorization": "Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ7XCJyb2xlXCI6XCJ7XFxcImRlbGV0ZWRcXFwiOjAsXFxcImlkXFxcIjoxLFxcXCJyb2xlTmFtZVxcXCI6XFxcIui2hee6p-euoeeQhuWRmFxcXCJ9XCIsXCJpZFwiOjEsXCJtZW51c1wiOlt7XCJkZWxldGVkXCI6MCxcIm1lbnVVcmxcIjpcIi9hdXRoXCIsXCJtZW51TmFtZVwiOlwi5p2D6ZmQ566h55CGXCIsXCJwaWRcIjowLFwic29ydE51bVwiOjAsXCJpZFwiOjF9LHtcImRlbGV0ZWRcIjowLFwibWVudVVybFwiOlwiL3VzZXJcIixcIm1lbnVOYW1lXCI6XCLnlKjmiLfnrqHnkIZcIixcInBpZFwiOjEsXCJzb3J0TnVtXCI6MCxcImlkXCI6Mn0se1wiZGVsZXRlZFwiOjAsXCJtZW51VXJsXCI6XCIvcm9sZVwiLFwibWVudU5hbWVcIjpcIuinkuiJsueuoeeQhlwiLFwicGlkXCI6MSxcInNvcnROdW1cIjoxLFwiaWRcIjozfSx7XCJkZWxldGVkXCI6MCxcIm1lbnVVcmxcIjpcIi9tb25pdG9yXCIsXCJtZW51TmFtZVwiOlwi5pyN5Yqh5Zmo55uR5o6nXCIsXCJwaWRcIjowLFwic29ydE51bVwiOjAsXCJpZFwiOjR9XSxcInVzZXJuYW1lXCI6XCJyb290XCJ9IiwiaXNzIjoiYWRtaW4iLCJleHAiOjE1OTY0Nzc1NjcsImlhdCI6MTU5NjQ3MDM2Nywicm9sIjoi6LaF57qn566h55CG5ZGYIn0.RDQQvTM-C0T_MHg5dwZKdhNZI-gd91uvbdnprFtTMiVpgJ5I0HzTxvau-W8r-_ZE7zDftHSpVgBnS0QIQZqwnQ"
            },
            dataType:"json",
            success:function(data){
            debugger
                //先添加所有的主材单
                $.each(data,function(i,obj){
                    var content='<li class="layui-nav-item layui-nav-itemed">';
                    content+='<a href="javascript:;" >'+obj.meunTitle+'</a>';
                    //这里是添加所有的子菜单
                    content+=loadchild(obj);
                    content+='</li>';
                    $(".layui-nav-tree").append(content);
                });
                element.init();
            }
        });

        //组装子菜单的方法
        function loadchild(obj){
            debugger
            if(obj==null){
                return;
            }

            var content='';
            if(obj.childrenList!=null && obj.childrenList.length>0){
                content+='<dl class="layui-nav-child">';
            }else{
                content+='<dl>';
            }

            if(obj.childrenList!=null && obj.childrenList.length>0){
                $.each(obj.childrenList,function(i,note){
                    content+='<dd>';
                    content+='<a href="javascript:;" data-url="menu2.html" data-id="'+note.meunSort+'" data-text="'+note.meunTitle+'"><span class="l-line"></span>后台菜单</a>';
                    if(note.childrenList == null){
                        return;
                    }
                    content+=loadchild(note);
                    content+='</dd>';
                });
                content+='</dl>';
            }
            console.log(content);
            return content;
        }
    });
</script>
</body>
</html>
